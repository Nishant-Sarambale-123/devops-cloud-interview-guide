Here is **Q151** in your required interview format.

---

# **151. How can AWS Lambda in one AWS account connect to an S3 bucket in another account?**

### **Short Explanation**

Tests cross-account access, IAM roles, and resource policies.

---

# **Answer**

Use **Resource-based policy** on S3 + **IAM role** for Lambda.
S3 bucket (Account B) must allow the Lambda role (Account A) to perform actions like `s3:GetObject` or `s3:PutObject`.

---

# **Detailed Explanation**

To allow Lambda from **Account A** to access an S3 bucket in **Account B**, you need **2 things**:

---

# **Step 1: Lambda Execution Role (Account A)**

Lambda gets an **IAM role** with S3 permissions:

```json
{
  "Effect": "Allow",
  "Action": ["s3:GetObject", "s3:ListBucket"],
  "Resource": [
    "arn:aws:s3:::my-bucket",
    "arn:aws:s3:::my-bucket/*"
  ]
}
```

This role *requests* access.

---

# **Step 2: S3 Bucket Policy (Account B)**

S3 bucket *grants* access via a **resource policy**:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::<ACCOUNT_A_ID>:role/<LambdaExecutionRole>"
      },
      "Action": ["s3:GetObject", "s3:ListBucket"],
      "Resource": [
        "arn:aws:s3:::my-bucket",
        "arn:aws:s3:::my-bucket/*"
      ]
    }
  ]
}
```

This allows **only the Lambda role** to access the bucket.

---

# **Optional Step 3: Use STS AssumeRole (More Secure)**

### If Account B provides a role to assume:

Account B creates a role:

```json
{
  "Effect": "Allow",
  "Principal": {
    "AWS": "arn:aws:iam::<ACCOUNT_A_ID>:role/<LambdaExecutionRole>"
  },
  "Action": "sts:AssumeRole"
}
```

Then Lambda in Account A assumes that role and gets temporary credentials to access S3.

---

# **Architecture Diagram (Conceptual)**

```
Lambda (A)
   ↓ assumes role → Role in B
   ↓
   Bucket Policy in B
   ↓
   S3 Bucket (B)
```

---

# **Summary Table**

| Method         | Description                      | Best For                    |
| -------------- | -------------------------------- | --------------------------- |
| Bucket Policy  | Allow Lambda role directly       | Simple cross-account access |
| STS AssumeRole | Lambda assumes role in Account B | Enterprise, secure setups   |

---

# **Key Takeaway**

**Cross-account S3 access always requires two things: Lambda role permissions + S3 bucket resource policy.**

---

Ready for **152. What is AWS STS and how does it work?**
