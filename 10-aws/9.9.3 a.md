Great — continuing with the **next interview question** in the same format.

---

# **155. Why did your EC2 instance’s CPU suddenly spike to 100%, and how do you troubleshoot it?**

## **Short Explanation:**

Tests ability to diagnose performance issues in Linux/Windows EC2.

---

## **Answer:**

Use **CloudWatch metrics**, check processes with **top/htop**, look for **application loops**, **memory leaks**, or **high I/O**, and verify **network traffic** or **attack patterns**.

---

## **Detailed Explanation:**

When CPU jumps to **100%**, follow these steps:

### **1. Check CloudWatch Metrics**

* CPUUtilization
* CPUCreditBalance (for t2/t3 burstable types)
* NetworkIn/Out
* DiskReadOps/WriteOps
  This gives the timeline of the spike.

### **2. Log Into the Instance**

**Linux:**

```bash
top -o %CPU
htop
ps aux --sort=-%cpu
```

**Windows:**

* Task Manager
* Resource Monitor
* Performance Monitor

Look for:

* Single process consuming CPU
* Java, Python, Node.js loops
* Database queries stuck
* Antivirus scans (Windows)

### **3. Check for App-Level Causes**

* Infinite loops
* Memory leaks causing swap
* Thread spikes
* Deadlocks
* Crash loops
* High traffic influx

### **4. Check for External Causes**

* DDoS attack → spike in network
* Unoptimized cron job
* Batch job running at peak time
* High DB calls from another service

### **5. Check System-Related Causes**

* CPU throttling (t2/t3 credits exhausted)
* Small instance type (t2.micro)
* Misconfigured startup script

### **6. Fix Options**

* Increase instance type
* Add auto scaling
* Optimize code
* Add caching (Redis)
* Enable WAF to block unwanted traffic
* Use load balancer to distribute load

---

## **Summary Table**

| Cause                  | How to Fix                |
| ---------------------- | ------------------------- |
| App infinite loop      | Fix code, restart service |
| Memory leak → swap     | Increase memory, fix app  |
| t2/t3 credit depletion | Switch to m5/c5 instance  |
| High network traffic   | Use WAF, ALB, scaling     |
| Heavy cron job         | Reschedule or optimize    |
| DB query explosion     | Add DB indexes, caching   |

---

## **Key Takeaway:**

**Always start with CloudWatch → then top/htop → then logs → then scale or optimize.**

---

Want the **next question (156)**?
