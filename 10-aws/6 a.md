Here is a clean, interview-ready answer for:

# **140. EC2 Instance terminated unexpectedly — How will you troubleshoot?**

---

## **1. Question**

**EC2 instance terminated unexpectedly. How will you troubleshoot?**

---

## **2. Short Explanation**

This question checks if you understand **AWS logging**, **monitoring**, and **lifecycle events** that can cause an EC2 to terminate.

---

## **3. Answer (Short & Crisp)**

To troubleshoot an EC2 termination, check **CloudTrail logs**, **Auto Scaling Group activity**, **Spot interruption notices**, **CloudWatch alarms**, and **billing alerts**. Also verify **termination protection** and **health checks**.

---

## **4. Detailed Explanation**

### ✅ **Step-by-step Troubleshooting**

---

### **1. Check CloudTrail Logs**

CloudTrail shows **who or what terminated the instance**.

Look for:

* `TerminateInstances` API call
* IAM user or role that triggered it
* Automated scripts (Terraform, Ansible, CI/CD pipelines)
* AWS internal service events

If you see:

```
TerminateInstances initiated by: arn:aws:iam::123456789:user/devops
```

→ Manual/API termination.

---

### **2. Check Auto Scaling Group (ASG) Activity**

If the instance is part of an ASG, it may be terminated due to:

* Failed health checks
* Scaling policies
* Deployment updates
* Instance refresh

Check **EC2 → Auto Scaling → Activity History**.

Example:

```
Cause: EC2 instance failed ELB health check
Action: Terminating instance and launching replacement
```

---

### **3. Check for Spot Instance Interruption (if Spot was used)**

AWS may terminate a Spot instance due to **price or capacity issues**.

Check:

* Spot Rebalance Recommendation
* Interruption Warning (2-minute notice)

CloudWatch event:

```
EC2 Spot Instance Interruption Warning
```

---

### **4. Review CloudWatch Alarms**

Instance may be terminated due to:

* Auto recovery failure
* System status check failed
* Health check alarm configured to trigger termination

Example alarm:

```
StatusCheckFailed_System = ALARM → Action: Terminate
```

---

### **5. Check AWS Billing Alerts**

If **credit exhausted (free tier)** or **budget alerts**, AWS may restrict services.

Spot or burstable T2/T3:

* CPU credits exhausted → performance degraded → health checks fail → ASG replaces instance.

---

### **6. Verify Termination Protection**

If it was disabled, instance can be deleted accidentally.

Path:
**EC2 → Instance → Actions → Change Termination Protection**

---

### **7. Investigate Instance Reboot/Hardware Issues**

Check:

* EC2 → Status Checks
* System logs (Console output)
* Kernel crashes

---

## **5. Summary Table**

| **Possible Cause**   | **How to Confirm**    | **Fix**                                                |
| -------------------- | --------------------- | ------------------------------------------------------ |
| Manual termination   | CloudTrail → API call | Enable termination protection                          |
| Auto Scaling         | ASG Activity Log      | Adjust scaling policy / health checks                  |
| Spot interruption    | CloudWatch Events     | Use On-Demand or Spot with capacity-optimized strategy |
| Health check failure | ELB/ASG logs          | Fix app issues / increase timeout                      |
| Billing-related      | Billing dashboard     | Raise limit / adjust instance type                     |
| Terraform/automation | CI/CD logs            | Add safeguards in code                                 |

---

## **6. Key Takeaway**

**Always start with CloudTrail, ASG activity logs, and Spot interruption events — together they explain 95% of unexpected terminations.**

---

If you want, I can now generate **Question 141: Lambda Function Fails Randomly — How will you fix the issue?** in the same format.
