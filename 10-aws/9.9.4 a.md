Great — continuing.

---

# **156. Your EC2 instance is running but you cannot SSH/RDP into it. How do you troubleshoot?**

## **Short Explanation:**

Tests ability to diagnose connectivity + networking issues in EC2.

---

## **Answer:**

Check **security groups**, **NACLs**, **route tables**, **key pair**, **SSH/RDP service**, and **EC2 system logs**. Also verify if the instance is **healthy**, **reachable**, and **not CPU throttled**.

---

## **Detailed Explanation:**

### **1. Security Group Issues**

Make sure inbound rules allow:

**SSH (Linux):**

```
Port 22 → Your IP
```

**RDP (Windows):**

```
Port 3389 → Your IP
```

Outbound must allow **0.0.0.0/0** or NAT for private instances.

---

### **2. NACL Issues**

* Check if inbound/outbound rules allow the traffic.
* Stateless rules → must allow both directions.
* “Deny” rules override everything.

---

### **3. Route Table Issues**

For a public instance:

* Must have route:

  ```
  0.0.0.0/0 → Internet Gateway
  ```

For a private instance:

* NAT Gateway or VPN/Direct Connect must be available.

---

### **4. Key Pair Problems (Linux)**

* Wrong key
* Wrong username (common mistake):

| AMI          | Username |
| ------------ | -------- |
| Amazon Linux | ec2-user |
| Ubuntu       | ubuntu   |
| RHEL         | ec2-user |
| CentOS       | centos   |

Check permissions:

```
chmod 400 mykey.pem
```

---

### **5. Check Instance Reachability**

Go to:
**EC2 → Instance → Status Checks**

If “Instance reachability failed” → OS-level issue.
If “System reachability failed” → Hardware/host issue.

---

### **6. Check System Logs**

In AWS Console:
**Actions → Monitor & Troubleshoot → Get System Log**

Look for:

* Kernel panic
* Disk full
* Firewall blocking SSH
* Boot failures

---

### **7. Check Local Firewall**

Linux:

```
sudo systemctl status sshd
sudo service sshd restart
sudo iptables -L
sudo ufw status
```

Windows:

* RDP service running?
* Windows Firewall blocking 3389?

---

### **8. High CPU Throttling (Burstable Instances)**

If CPU credits exhausted → instance becomes unresponsive.
Fix:

* Change instance type
* Stop/start instance (resets credits for T2 only)

---

### **9. Fixing Boot-Level Issues Using SSM**

If SSM Agent installed →
You can log in **without SSH/RDP** using:

**Session Manager → Start Session**

---

### **10. Rescue Method**

If nothing works:

1. Stop the instance
2. Detach EBS root volume
3. Attach to another instance
4. Fix configs/logs
5. Reattach to original instance

---

## **Summary Table**

| Issue                 | Fix                            |
| --------------------- | ------------------------------ |
| SG/NACL block         | Allow correct ports            |
| Wrong route table     | Add IGW/NAT                    |
| Wrong key/user        | Fix pem + username             |
| SSH/RDP service down  | Restart service                |
| Boot failure          | Check system logs              |
| CPU credit exhaustion | Resize instance                |
| Disk full             | Mount volume on another server |

---

## **Key Takeaway:**

**90% of SSH/RDP issues are caused by SG, NACL, or route table misconfiguration.**

---

Ready for the next one — **157. Application on EC2 is slow. What will you check?**
