Here is **Q154** in your required detailed interview format.

---

# **154. How a Lambda function in AWS Account A interacts with DynamoDB in Account B?**

### **Short Explanation**

Checks cross-account access design using **IAM Roles + STS AssumeRole + Trust Policies**.

---

# **Answer**

A Lambda in Account A can access DynamoDB in Account B by:

1. Creating an IAM Role in **Account B** with DynamoDB permissions.
2. Adding a **Trust Policy** allowing the Lambda’s role from Account A to **AssumeRole**.
3. Lambda in Account A calls **STS:AssumeRole** to get temporary credentials.
4. Lambda uses those temporary credentials to access DynamoDB in B.

---

# **Detailed Explanation**

Cross-account access works using **IAM roles + STS**.

Below is the exact step-by-step process.

---

# ✅ **Step 1: Create IAM Role in Account B**

This role contains **permissions** to access DynamoDB:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "dynamodb:*",
      "Resource": "arn:aws:dynamodb:region:AccountB:table/MyTable"
    }
  ]
}
```

---

# ✅ **Step 2: Add Trust Policy (Very Important)**

Trust policy in **Account B** role must allow Account A Lambda to assume it:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::ACCOUNT_A_ID:role/LambdaExecutionRole"
      },
      "Action": "sts:AssumeRole"
    }
  ]
}
```

This tells AWS:

> *“Lambda role in Account A is trusted to assume this role.”*

---

# ✅ **Step 3: Lambda in Account A Calls STS AssumeRole**

Inside Lambda code:

```python
import boto3

sts = boto3.client('sts')

assumed = sts.assume_role(
    RoleArn="arn:aws:iam::ACCOUNT_B_ID:role/CrossAccountDynamoRole",
    RoleSessionName="lambda-session"
)

creds = assumed['Credentials']

dynamodb = boto3.client(
    'dynamodb',
    aws_access_key_id=creds['AccessKeyId'],
    aws_secret_access_key=creds['SecretAccessKey'],
    aws_session_token=creds['SessionToken']
)
```

Lambda now receives:

* AccessKeyId
* SecretAccessKey
* SessionToken (STS token)

---

# ✅ **Step 4: Lambda Accesses DynamoDB in Account B**

Now the Lambda performs read/write operations using temporary credentials.

Example:

```python
dynamodb.put_item(
    TableName='MyTable',
    Item={'id': {'S': '123'}}
)
```

---

# **Key Points to Mention in Interview**

### ✔ Security Best Practices

* Never share long-term access keys
* Use STS temporary credentials
* Restrict trust policy to specific role, not entire account

### ✔ Required Components

| Component             | Where     | Purpose                         |
| --------------------- | --------- | ------------------------------- |
| IAM Role              | Account B | Gives DynamoDB permissions      |
| Trust Policy          | Account B | Allows Account A role to assume |
| Lambda Execution Role | Account A | Calls STS AssumeRole            |
| STS AssumeRole        | AWS       | Provides temporary credentials  |

---

# **Key Takeaway**

**Cross-account access = IAM Role (Account B) + Trust Policy + STS AssumeRole + Lambda Execution Role (Account A).**

---

Ready for **155. What are the disadvantages of using EBS volumes in Kubernetes?**
