Here is the next one in the **same interview-ready format**.

---

# **141. Lambda Function Fails Randomly — How will you fix the issue?**

---

## **1. Question**

**Your AWS Lambda function is failing randomly. How will you troubleshoot and fix it?**

---

## **2. Short Explanation**

This tests your ability to debug **serverless applications**, including logs, timeouts, concurrency, retries, and permissions.

---

## **3. Answer (Short & Crisp)**

Check **CloudWatch logs**, **timeout/memory settings**, **IAM permissions**, **event size**, **retries/DLQ/SQS**, **VPC networking**, and **third-party API timeouts**. Fix based on the exact error seen.

---

## **4. Detailed Explanation**

Here’s the full troubleshooting flow:

---

### ✅ **1. Check CloudWatch Logs (Most Important)**

Look for:

* Syntax errors
* Timeouts
* Out Of Memory
* Permission Denied
* Invalid Payload
* API throttling
* Dependency import errors

Example error:

```
Task timed out after 3.00 seconds
```

→ Increase timeout or optimize code.

---

### ✅ **2. Check Timeout & Memory Allocation**

Most random failures come from:

* **Timeout too low**
* **Memory too low**

Fix:

* Increase **timeout** (default = 3 sec, maximum = 15 min).
* Increase **memory** (also increases CPU).

---

### ✅ **3. Check IAM Permissions**

Lambda may fail **randomly** if certain branches/code paths need more permissions.

Check the Lambda execution role:

* S3 access
* DynamoDB read/write
* SQS poll/send
* CloudWatch put logs

Example:

```
AccessDeniedException: User is not authorized to perform dynamodb:PutItem
```

---

### ✅ **4. Check VPC Configuration (Very Common Issue)**

If Lambda is inside a VPC:

* Missing NAT Gateway → no internet
* ENI exhaustion
* Wrong security groups
* Subnets with no route to app/database

Errors look like:

```
ECONNRESET
Connection timed out
```

Fix:

* Use **private subnets + NAT** or
* Keep Lambda **outside VPC** if not needed.

---

### ✅ **5. Check Event Payload (S3/SQS/EventBridge)**

Random failures often due to:

* Bad JSON
* Unexpected payload fields
* Large data size (Lambda limit = 6 MB for sync, 256 KB for async)

---

### ✅ **6. Check Concurrency & Throttling**

If traffic spikes:

* Lambda might hit **concurrency limits**
* Downstream services may throttle

Check:

* CloudWatch → Invocation count
* Throttles
* Errors

Fix:

* Set **Reserved Concurrency**
* Increase **account concurrency limit** via AWS support
* Add **SQS buffer** for smoothing traffic

---

### ✅ **7. Check Retries, DLQ, and SQS (if async)**

Lambda retries async events **twice** by default.

Look for:

* Messages stuck in DLQ
* Messages reprocessed multiple times
* Poison-pill messages (always failing)

---

### ✅ **8. Check Third-Party API Issues**

If Lambda calls an external API:

* Rate limiting
* Slow response
* DNS failure
* Certificate issues

Fix:

* Add retries
* Increase timeout
* Use exponential backoff

---

## **5. Summary Table**

| Issue                   | Symptom                | Fix                        |
| ----------------------- | ---------------------- | -------------------------- |
| Timeout too low         | Random timeouts        | Increase timeout           |
| Low memory              | Crashes/OOM            | Increase memory + CPU      |
| VPC networking          | Connection errors      | Add NAT / fix SG / routing |
| Missing IAM permissions | AccessDenied errors    | Update IAM role            |
| Payload issues          | Occasional JSON errors | Validate payloads          |
| Third-party API issues  | Random API failures    | Add retries/backoff        |
| Concurrency throttling  | Throttle errors        | Increase concurrency limit |

---

## **6. Key Takeaway**

**CloudWatch logs + timeout/memory + IAM + VPC networking explain almost every random Lambda failure.**

---

Ready for **142. What will you do when AWS RDS Storage is Full?**
